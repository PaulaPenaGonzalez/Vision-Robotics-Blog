<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proyecto 1 - Detección de Bordes</title>
    <link rel="stylesheet" href="../styles.css">
</head>
<body>
    <header>
        <h1>Control de un F1 🏎️ </h1>
        <p>Progreso y avances de este proyecto.</p>
    </header>

    <!-- Introducción antes de las publicaciones -->
    <div class="container">
    	<p>
        	Este proyecto explora la aplicación de visión por computadora para el seguimiento de líneas en un coche de Fórmula 1 dentro del entorno de Unibotics. A lo largo de su desarrollo, hemos implementado diferentes estrategias de control, desde decisiones discretas hasta el uso de un controlador PID. 
    	</p>
    	<p>
        A continuación, puedes leer las publicaciones relacionadas con este proyecto, donde se detallan los avances, problemas encontrados y soluciones aplicadas. 
    	</p>
    </div>


    <div class="container">
         <h2>Publicaciones</h2>
   	 <button onclick="mostrarPost(1)"> Primer post: Fase 1</button>
    	 <button onclick="mostrarPost(2)"> Segundo post: Fase 2</button>
	 <button onclick="mostrarPost(3)"> Tercer post: Fase 3</button>
    </div>

    <!-- Contenido del primer post -->
    <div id="post1" class="post-container" style="display: none;">
    	<h2>Objetivo: Seguimiento de una Línea Roja en Unibotics con un Coche de Fórmula 1</h2>

    	<h3>1️⃣ Enfoque Inicial: Decisiones Discretas</h3>
    	<p>El primer enfoque se basó en establecer una velocidad constante y detectar la posición de la línea roja en la imagen a cada instante:</p>
    	<ul>
        	<li> Si la línea está a la izquierda, girar a la izquierda.</li>
        	<li> Si la línea está a la derecha, girar a la derecha.</li>
        	<li> Si la línea está centrada, avanzar recto.</li>
        	<li> Si no se detecta la línea, seguir la última dirección o realizar búsqueda oscilante.</li>
    	</ul>

    	<h3>2️⃣ Mejorando la Precisión con un Controlador PID</h3>
    	<p>Para mejorar el seguimiento, se integró un <strong>controlador PID</strong> para ajustar el giro del coche de manera progresiva.</p>

    	<h4>📝 Concepto del PID</h4>
    	<ul>
        	<li><strong>Componente Proporcional (P):</strong> Ajusta la dirección según la desviación respecto a la línea.</li>
        	<li><strong>Componente Integral (I):</strong> Compensa errores acumulados en el tiempo.</li>
        	<li><strong>Componente Derivativo (D):</strong> Reduce oscilaciones corrigiendo cambios bruscos.</li>
    	</ul>

    	<h3>3️⃣ Problemas Encontrados y Soluciones</h3>
    	<h4>🛠️ Errores con OpenCV (`cv2`)</h4>
	<p>Al ejecutar el código en Unibotics, se encontraron errores indicando que OpenCV (<code>cv2</code>) no estaba funcionando correctamente. Para solucionarlo:</p>

	<ol>
    		<li><strong>Se verificó si OpenCV está instalado</strong> ejecutando:</li>
    		<pre><code>
import cv2
print(cv2.__version__)
    		</code></pre>

    		<li><strong>Se intentó usar <code>opencv-python-headless</code></strong> en caso de falta de soporte gráfico:</li>
    		<pre><code>
pip install opencv-python-headless
    		</code></pre>

    		<li><strong>Se probó una importación alternativa</strong> en caso de problemas de compatibilidad, lo que finalmente solucionó el problema:</li>
    		<pre><code>
import cv2.cv2 as cv2
    		</code></pre>
	</ol>
    	
    	<h4>⚙️ Variables Globales en Python</h4>
    	<p>Para manejar el historial de errores en el controlador PID:</p>
    	<ul>
        	<li> Se definen `error_anterior` e `integral` fuera de la función.</li>
        	<li> Se usa `global error_anterior, integral` dentro de la función.</li>
    	</ul>
	
	<h4>⚙️Valores de las constantes en el controlador PID y reacción del sistema.<</h4>
        <p>Para los siguientes valores del controlador PID:</p>
        <ul>  
                <li>kp = 0.005 </l$               
		<li>ki = 0.0001 </$
		<li>kd = 0.002 </$        
	</ul>

    	<h3>4️⃣ Resultados y Conclusiones</h3>
    	<p>Comparando ambos enfoques:</p>
    	<ul>
        	<li>✅ El método de decisiones discretas es fácil de implementar, pero menos preciso.</li>
        	<li>✅ El controlador PID mejora la estabilidad y permite un movimiento fluido en el circuito.</li>
    	</ul>

    	<h3>5️⃣ Próximos Pasos</h3>
    	<ul>
        	<li>🚀 Ajustar los valores de <strong>Kp, Ki y Kd</strong> para optimizar el PID.</li>
        	<li>🛑 Agregar detección de obstáculos para evitar colisiones.</li>
        	<li>🔄 Implementar una estrategia de recuperación si la línea se pierde.</li>
    	</ul>

    </div>

    <!-- Contenido del segundo post -->
    <div id="post2" class="post-container" style="display: none;">
        <h2>🚗 Seguimiento de Línea con PID en Unibotics - Día 2</h2>
        <p>En este segundo día de trabajo, hemos realizado ajustes importantes en la implementación del controlador PID para mejorar la estabilidad y la capacidad del coche para seguir la línea roja en Unibotics.</p>
        
        <h2>🔹 Mejoras con respecto al Día 1</h2>
        <ul>
            <li><strong>Implementación del Controlador PID:</strong> Se han definido las constantes <code>Kp</code>, <code>Ki</code> y <code>Kd</code> con valores ajustados para una mejor respuesta.</li>
            <li><strong>Corrección del Giro:</strong> Ahora el coche ajusta su dirección en función de la desviación respecto al centro de la línea roja utilizando OpenCV.</li>
            <li><strong>Detección de la Línea Mejorada:</strong> Se ha implementado la detección basada en contornos con <code>cv2.findContours</code> para determinar el centro de la línea con mayor precisión.</li>
            <li><strong>Estrategia de Recuperación:</strong> Se ha añadido una lógica que permite recordar la última dirección detectada cuando la línea desaparece momentáneamente.</li>
            <li><strong>Visualización del Proceso:</strong> Se ha incorporado <code>GUI.showImage(mask)</code> para visualizar la segmentación de la línea roja en tiempo real.</li>
        </ul>
        
        <h2>📌 Resultados y Observaciones</h2>
        <p>Gracias a estas mejoras, el coche sigue la línea con mayor precisión. Sin embargo, aún hay margen de mejora en la gestión de la velocidad y la recuperación cuando la línea se pierde completamente.</p>
        
        <h2>📈 Próximos Pasos</h2>
        <ul>
            <li>🚀 Ajustar los valores de <code>Kp</code>, <code>Ki</code> y <code>Kd</code> para mejorar la estabilidad.</li>
            <li>🔄 Implementar una estrategia de oscilación para cuando el coche pierda la línea roja.</li>
            <li>⚙️ Explorar la posibilidad de controlar la velocidad mediante un PID adicional.</li>
        </ul>
        
        <p>💬 ¿Qué opinas de los avances hasta ahora? ¡Déjanos tus comentarios! 🚀</p>
    </div>

    <!--Contenido del tercer post -->
    <div id="post3" class="post-container" style="display: none;">
        <h2>🚗 Seguimiento de Línea con PID en Unibotics - Día 3</h2>
        <p>En esta tercera iteración, hemos mejorado la segmentación de la línea roja utilizando un enfoque basado en una franja superior de la imagen. Este cambio nos permite anticiparnos mejor a las curvas.</p>
        
        <h2>🔹 Mejoras con respecto al Día 2</h2>
        <ul>
            <li><strong>Selección de una Franja Superior:</strong> En lugar de analizar toda la imagen, ahora utilizamos solo una ventana en la parte superior, lo que mejora la anticipación en curvas.</li>
            <li><strong>Reducción de Ruido:</strong> Al enfocarnos en una franja específica, eliminamos información irrelevante que podía afectar el cálculo del centro de la línea.</li>
            <li><strong>Corrección del PID:</strong> Se ajustaron los parámetros del PID para adaptarse a la nueva estrategia de detección.</li>
            <li><strong>Visualización de la Máscara:</strong> Se añadió una función para mostrar solo la franja seleccionada, permitiendo depurar mejor el procesamiento de la imagen.</li>
        </ul>
        
        <h2>📌 Resultados y Observaciones</h2>
        <p>Con esta mejora, el coche ahora reacciona con mayor antelación a las curvas, reduciendo la oscilación y mejorando la estabilidad en el seguimiento de la línea. Sin embargo, todavía debemos ajustar los valores del PID para optimizar la respuesta en curvas más cerradas.</p>
        
        <h2>📈 Próximos Pasos</h2>
        <ul>
            <li>🚀 Seguir ajustando los valores del PID para mejorar la estabilidad.</li>
            <li>🔄 Explorar la posibilidad de un PID adaptativo que ajuste su comportamiento en tiempo real.</li>
            <li>⚙️ Implementar una estrategia de búsqueda más eficiente cuando el coche pierda la línea.</li>
        </ul>
        
        <p>💬 ¿Qué opinas de esta nueva estrategia? ¡Déjanos tus comentarios! 🚀</p>
    </div>
	
    <script>
        function mostrarPost(num) {
            let post1 = document.getElementById('post1');
            let post2 = document.getElementById('post2');

            post1.style.opacity = 0;
            post2.style.opacity = 0;
            post1.style.display = 'none';
            post2.style.display = 'none';

            setTimeout(() => {
                if (num === 1) {
                    post1.style.display = 'block';
                    setTimeout(() => {
                        post1.style.opacity = 1;
                        post1.style.transform = 'translateY(0)';
                    }, 50);
                } else if (num === 2) {
                    post2.style.display = 'block';
                    setTimeout(() => {
                        post2.style.opacity = 1;
                        post2.style.transform = 'translateY(0)';
                    }, 50);
                }
            }, 200);
        }
    </script>

    <!-- 📌 Footer al final de la página -->
    <footer>
        <p><a href="../index.html">Volver a la página principal</a></p>
    </footer>
</body>
</html>

